<!-- https://www.geeksforgeeks.org/how-to-control-fps-with-requestanimationframe/ -->
<head><meta charset="UTF-8"></head>
<h2>Control FPS with requestAnimationFrame</h2> 

<label for="target">TargetFPS:</label>
<input id="TargetFPS" type="range" min="1" max="60" value="30" oninput="inputTaregtFPS()" onchange="changeTaregtFPS()">
<label style="padding-right: 20px;" id="targetFPSLabel">30 FPS</label>
<label for="independent">Uncapped FPS</label><input type="checkbox" checked></input>
<br>
<table>
    <tr>
        <td style="width: 33%;"><label for="independent">FrameIndependent</label><input type="checkbox" checked></input></td>
        <td style="width: 33%; padding: 10px;"><p id="fpsCounter" >fps:10</p></td>
        <td style="width: 33%; padding: 10px;"><p id="frameTime">FrameTime: 16ms</p></td>
    </tr>
</table>

<div id="rect" style="position: absolute; left: 10px; width: 100px;height:100px; background-color:lightseagreen;"></div>
  
<script> 
//TODO:Needs refactoring and simplification

////GUI/////
var targetFPSLabel = document.getElementById("targetFPSLabel");
var uncapped = false;
var frameIndependent = false;
var frameCounter  = document.getElementById("fpsCounter");
var frameTime  = document.getElementById("frameTime");
var fpsTarget = 30;

function inputTaregtFPS(value)
{
    targetFPSLabel.innerHTML = document.getElementById("TargetFPS").value+" FPS";
}

function changeTaregtFPS()
{
    fpsTarget = document.getElementById("TargetFPS").value;
}
////END-GUI//////git init

var lastTick = Date.now();
var dt = 0;


animate()
function render(time)
{
    dt = (time-lastTick)/100;

    if(dt>=(1/fpsTarget))
    {
        lastTick = time;
    }


    console.log(dt , 1/fpsTarget)

    frameTime.innerHTML = "FrameTime:"+dt+"ms";

    frameCounter.innerHTML = "FPS: "+fpsTarget;

}

// Animation loop
function animate(){
    requestAnimationFrame(animate);
    // Render scene
    render(Date.now());
}




</script> 